<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>凡人修仙传 - 完整剧情模拟器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c2461, #1e3799);
            color: #e6e6e6;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 3fr 1fr;
            grid-gap: 20px;
        }
        
        header {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #4a69bd;
        }
        
        h1 {
            color: #f6b93b;
            text-shadow: 0 0 10px rgba(246, 185, 59, 0.5);
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .subtitle {
            color: #82ccdd;
            font-size: 1.2rem;
        }
        
        .panel {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #4a69bd;
            box-shadow: 0 0 15px rgba(74, 105, 189, 0.3);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .panel h2 {
            color: #f6b93b;
            border-bottom: 1px solid #4a69bd;
            padding-bottom: 10px;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .character-info {
            display: flex;
            flex-direction: column;
        }
        
        .avatar {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #2c3e50, #4a69bd);
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #f6b93b;
            overflow: hidden;
            position: relative;
        }
        
        .avatar-content {
            text-align: center;
            color: #f6b93b;
            padding: 10px;
            z-index: 2;
        }
        
        .avatar-content .name {
            font-size: 1.8rem;
            margin-bottom: 5px;
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
        }
        
        .avatar-content .level {
            font-size: 1.3rem;
            color: #82ccdd;
            margin-bottom: 10px;
        }
        
        .avatar-content .location {
            font-size: 1.1rem;
            color: #78e08f;
        }
        
        .stats {
            width: 100%;
            margin-bottom: 15px;
        }
        
        .stat {
            margin-bottom: 12px;
        }
        
        .stat label {
            display: block;
            margin-bottom: 5px;
            color: #82ccdd;
            font-size: 1rem;
        }
        
        .progress-bar {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #f6b93b, #e55039);
            border-radius: 10px;
            transition: width 0.5s;
        }
        
        .skills-list, .items-list, .maps-list {
            list-style-type: none;
        }
        
        .skill, .item, .map {
            padding: 12px;
            margin-bottom: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            border-left: 4px solid #4a69bd;
            transition: all 0.3s;
        }
        
        .skill:hover, .item:hover, .map:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .skill-name, .item-name, .map-name {
            font-weight: bold;
            color: #82ccdd;
            font-size: 1.1rem;
        }
        
        .skill-desc, .item-desc, .map-desc {
            font-size: 0.95rem;
            color: #aaa;
            margin-top: 5px;
            line-height: 1.5;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
        }
        
        .story-container {
            flex-grow: 1;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            margin-bottom: 20px;
            min-height: 400px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .story-text {
            margin-bottom: 15px;
            line-height: 1.8;
            padding: 8px;
            border-radius: 5px;
            background: rgba(255,255,255,0.03);
        }
        
        .story-character {
            color: #f6b93b;
            font-weight: bold;
        }
        
        .choices-container {
            display: grid;
            grid-template-columns: 1fr;
            grid-gap: 12px;
            margin-bottom: 15px;
        }
        
        .choice-btn {
            padding: 15px;
            background: linear-gradient(135deg, #4a69bd, #1e3799);
            border: none;
            border-radius: 5px;
            color: white;
            font-size: 1.05rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }
        
        .choice-btn:hover {
            background: linear-gradient(135deg, #1e3799, #0c2461);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .location-info {
            margin-top: 15px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .location-name {
            color: #f6b93b;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .novel-progress {
            margin-top: 20px;
        }
        
        .progress-text {
            text-align: center;
            margin-bottom: 8px;
            color: #82ccdd;
            font-size: 1.1rem;
        }
        
        .chapter-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .nav-btn {
            padding: 10px 20px;
            background: #4a69bd;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .nav-btn:hover {
            background: #1e3799;
        }
        
        .nav-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }
        
        .era-progress {
            margin-top: 15px;
        }
        
        .era-name {
            text-align: center;
            color: #f6b93b;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        footer {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            font-size: 1rem;
            color: #aaa;
        }
        
        @media (max-width: 1100px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .panel {
                max-height: none;
            }
        }
        
        .event-special {
            color: #f6b93b;
            font-weight: bold;
        }
        
        .event-danger {
            color: #e55039;
        }
        
        .event-lucky {
            color: #78e08f;
        }
        
        .timeline {
            margin-top: 15px;
        }
        
        .timeline-item {
            padding: 8px 12px;
            margin-bottom: 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
            border-left: 3px solid #4a69bd;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .timeline-item:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: #f6b93b;
        }
        
        .timeline-era {
            color: #f6b93b;
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 8px;
            padding-bottom: 5px;
            border-bottom: 1px solid #4a69bd;
        }
        
        .completed {
            opacity: 0.7;
            border-left-color: #78e08f;
        }
        
        .current {
            border-left-color: #f6b93b;
            background: rgba(246, 185, 59, 0.1);
        }
        
        .upcoming {
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>凡人修仙传 - 完整剧情模拟器</h1>
            <p class="subtitle">体验韩立从凡人到道祖的完整修仙之路</p>
        </header>
        
        <div class="panel character-info">
            <div class="avatar">
                <div class="avatar-content">
                    <div class="name">韩立</div>
                    <div class="level" id="cultivation-level">炼气期三层</div>
                    <div class="location" id="current-location">七玄门</div>
                </div>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <label>境界进度</label>
                    <div class="progress-bar">
                        <div class="progress" id="level-bar" style="width: 5%"></div>
                    </div>
                </div>
                
                <div class="stat">
                    <label>剧情进度</label>
                    <div class="progress-bar">
                        <div class="progress" id="story-bar" style="width: 2%"></div>
                    </div>
                </div>
                
                <div class="stat">
                    <label>人界篇进度</label>
                    <div class="progress-bar">
                        <div class="progress" id="mortal-bar" style="width: 10%"></div>
                    </div>
                </div>
            </div>
            
            <h2>修炼功法</h2>
            <ul class="skills-list" id="skills-list">
                <li class="skill">
                    <div class="skill-name">长春功</div>
                    <div class="skill-desc">木属性基础功法，墨大夫所传授</div>
                </li>
            </ul>
            
            <h2>重要物品</h2>
            <ul class="items-list" id="items-list">
                <li class="item">
                    <div class="item-name">神秘小瓶</div>
                    <div class="item-desc">可催生植物的神奇瓶子</div>
                </li>
            </ul>
        </div>
        
        <div class="panel main-content">
            <h2>剧情发展</h2>
            <div class="story-container" id="story-container">
                <div class="story-text">
                    <span class="story-character">[旁白]</span> 
                    你叫韩立，出身于一个普通的山村家庭。因为家境贫寒，父母将你送到七玄门做弟子，希望你能学些本事，将来有个好出路。
                </div>
                <div class="story-text">
                    <span class="story-character">[张铁]</span> 
                    "韩师弟，快醒醒！今天墨大夫要挑选弟子，这可是我们出人头地的好机会！"
                </div>
                <div class="story-text">
                    <span class="story-character">[旁白]</span> 
                    你揉了揉惺忪的睡眼，跟着张铁来到了七玄门的练武场。场中站着一位面色阴沉的中年人，正是门中人人敬畏的墨大夫。
                </div>
            </div>
            
            <div class="choices-container" id="choices-container">
                <button class="choice-btn" data-next="1">主动上前，希望被墨大夫选中</button>
                <button class="choice-btn" data-next="2">躲在人群后面，观察情况</button>
                <button class="choice-btn" data-next="3">向张铁询问墨大夫的详细情况</button>
            </div>
            
            <div class="location-info">
                当前位置: <span class="location-name" id="location-name">七玄门练武场</span>
            </div>
            
            <div class="era-progress">
                <div class="era-name" id="era-name">人界篇 - 初入七玄门</div>
                <div class="progress-bar">
                    <div class="progress" id="chapter-bar" style="width: 2%"></div>
                </div>
            </div>
            
            <div class="chapter-nav">
                <button class="nav-btn" id="prev-chapter" disabled>上一章</button>
                <button class="nav-btn" id="next-chapter">下一章</button>
                <button class="nav-btn" id="jump-timeline">剧情时间线</button>
            </div>
        </div>
        
        <div class="panel">
            <h2>剧情时间线</h2>
            <div class="timeline">
                <div class="timeline-era">人界篇</div>
                <div class="timeline-item current" data-chapter="0">初入七玄门</div>
                <div class="timeline-item upcoming" data-chapter="1">墨大夫的考验</div>
                <div class="timeline-item upcoming" data-chapter="2">神秘小瓶</div>
                <div class="timeline-item upcoming" data-chapter="3">墨大夫的阴谋</div>
                <div class="timeline-item upcoming" data-chapter="4">踏入黄枫谷</div>
                <div class="timeline-item upcoming" data-chapter="5">血色禁地</div>
                <div class="timeline-item upcoming" data-chapter="6">筑基成功</div>
                <div class="timeline-item upcoming" data-chapter="7">虚天殿探秘</div>
                <div class="timeline-item upcoming" data-chapter="8">坠魔谷之战</div>
                <div class="timeline-item upcoming" data-chapter="9">元婴大成</div>
                <div class="timeline-item upcoming" data-chapter="10">大晋游历</div>
                <div class="timeline-item upcoming" data-chapter="11">昆吾山</div>
                <div class="timeline-item upcoming" data-chapter="12">飞升灵界</div>
                
                <div class="timeline-era">灵界篇</div>
                <div class="timeline-item upcoming" data-chapter="13">初入灵界</div>
                <div class="timeline-item upcoming" data-chapter="14">天渊城</div>
                <div class="timeline-item upcoming" data-chapter="15">广寒界</div>
                <div class="timeline-item upcoming" data-chapter="16">魔界入侵</div>
                <div class="timeline-item upcoming" data-chapter="17">螟虫之母</div>
                <div class="timeline-item upcoming" data-chapter="18">大乘修士</div>
                <div class="timeline-item upcoming" data-chapter="19">马良之战</div>
                <div class="timeline-item upcoming" data-chapter="20">飞升仙界</div>
                
                <div class="timeline-era">仙界篇</div>
                <div class="timeline-item upcoming" data-chapter="21">北寒仙域</div>
                <div class="timeline-item upcoming" data-chapter="22">真言门遗迹</div>
                <div class="timeline-item upcoming" data-chapter="23">轮回殿主</div>
                <div class="timeline-item upcoming" data-chapter="24">时间道祖</div>
                <div class="timeline-item upcoming" data-chapter="25">终结道祖</div>
            </div>
            
            <h2 style="margin-top: 20px;">重要人物</h2>
            <ul class="skills-list">
                <li class="skill">
                    <div class="skill-name">墨大夫</div>
                    <div class="skill-desc">七玄门医师，神秘莫测</div>
                </li>
                <li class="skill">
                    <div class="skill-name">南宫婉</div>
                    <div class="skill-desc">韩立道侣，掩月宗长老</div>
                </li>
                <li class="skill">
                    <div class="skill-name">大衍神君</div>
                    <div class="skill-desc">千竹教创派祖师，神魂状态</div>
                </li>
                <li class="skill">
                    <div class="skill-name">银月</div>
                    <div class="skill-desc">银月狼族，器灵</div>
                </li>
            </ul>
        </div>
        
        <footer>
            <p>《凡人修仙传》完整剧情模拟器 - 包含人界篇、灵界篇、仙界篇全部主要剧情</p>
            <p>境界体系：炼气 → 筑基 → 金丹 → 元婴 → 化神 → 炼虚 → 合体 → 大乘 → 真仙 → 金仙 → 太乙 → 大罗 → 道祖</p>
        </footer>
    </div>

    <script>
        // 小说完整剧情数据
        const novelChapters = [
            // 人界篇
            {
                id: 0,
                title: "初入七玄门",
                era: "人界篇",
                location: "七玄门练武场",
                level: "炼气期三层",
                story: [
                    "[旁白] 你叫韩立，出身于一个普通的山村家庭。因为家境贫寒，父母将你送到七玄门做弟子，希望你能学些本事，将来有个好出路。",
                    "[张铁] \"韩师弟，快醒醒！今天墨大夫要挑选弟子，这可是我们出人头地的好机会！\"",
                    "[旁白] 你揉了揉惺忪的睡眼，跟着张铁来到了七玄门的练武场。场中站着一位面色阴沉的中年人，正是门中人人敬畏的墨大夫。"
                ],
                choices: [
                    { text: "主动上前，希望被墨大夫选中", next: 1 },
                    { text: "躲在人群后面，观察情况", next: 2 },
                    { text: "向张铁询问墨大夫的详细情况", next: 3 }
                ]
            },
            {
                id: 1,
                title: "墨大夫的挑选",
                era: "人界篇",
                location: "七玄门练武场",
                level: "炼气期三层",
                story: [
                    "[旁白] 你鼓起勇气，主动走到人群前方。墨大夫锐利的目光在你身上停留片刻，微微点头。",
                    "[墨大夫] \"你，叫什么名字？\"",
                    "[韩立] \"弟子韩立。\"",
                    "[墨大夫] \"从今天起，你便跟着我学习医术吧。\"",
                    "[旁白] 你成功被墨大夫选中，成为了他的弟子。张铁羡慕地看着你，而其他弟子则投来嫉妒的目光。"
                ],
                choices: [
                    { text: "感谢墨大夫，并表示会努力学习", next: 4 },
                    { text: "询问墨大夫具体要学习什么", next: 5 }
                ]
            },
            {
                id: 2,
                title: "谨慎观察",
                era: "人界篇",
                location: "七玄门练武场",
                level: "炼气期三层",
                story: [
                    "[旁白] 你决定先观察情况，躲在人群后面。你注意到墨大夫挑选弟子时，特别关注弟子的根骨和精气神。",
                    "[旁白] 最终，墨大夫选中了包括你在内的三名弟子。他的目光在你身上多停留了一会儿，让你感到一丝不安。",
                    "[张铁] \"韩师弟，恭喜你！不过墨大夫看起来有点可怕啊...\""
                ],
                choices: [
                    { text: "安慰张铁，表示会小心行事", next: 4 },
                    { text: "询问张铁对墨大夫的了解", next: 6 }
                ]
            },
            {
                id: 3,
                title: "打听消息",
                era: "人界篇",
                location: "七玄门练武场",
                level: "炼气期三层",
                story: [
                    "[韩立] \"张师兄，这位墨大夫是什么来历？\"",
                    "[张铁] \"听说墨大夫医术高超，但性格古怪，很少收徒。前几批跟他学习的弟子，后来都变得沉默寡言，很少与人交往。\"",
                    "[旁白] 你心中升起一丝疑虑，但此时墨大夫已经注意到了你们。",
                    "[墨大夫] \"你们两个，过来。\"",
                    "[旁白] 你和张铁都被墨大夫选中，成为了他的弟子。"
                ],
                choices: [
                    { text: "接受现实，开始跟随墨大夫学习", next: 4 },
                    { text: "保持警惕，暗中观察墨大夫", next: 7 }
                ]
            },
            {
                id: 4,
                title: "开始修炼",
                era: "人界篇",
                location: "墨大夫居所",
                level: "炼气期三层",
                story: [
                    "[旁白] 你开始跟随墨大夫学习。他首先传授给你的是一门名为《长春功》的养生功法。",
                    "[墨大夫] \"此功法可强身健体，延年益寿。你需每日勤加练习，不可懈怠。\"",
                    "[旁白] 你发现修炼《长春功》后，精神确实好了许多，但墨大夫每隔一段时间就要检查你的修炼进度，态度异常认真。",
                    "[旁白] 某日，你在后山练习时，偶然发现了一个散发着微弱绿光的神秘小瓶。"
                ],
                choices: [
                    { text: "将小瓶收起来，不告诉任何人", next: 8 },
                    { text: "向墨大夫报告这个发现", next: 9 },
                    { text: "与张铁分享这个秘密", next: 10 }
                ]
            },
            {
                id: 5,
                title: "直接询问",
                era: "人界篇",
                location: "墨大夫居所",
                level: "炼气期三层",
                story: [
                    "[韩立] \"墨大夫，弟子愚钝，不知具体要学习哪些医术？\"",
                    "[墨大夫] \"先修炼《长春功》，打好基础。医术之事，日后自然教你。\"",
                    "[旁白] 墨大夫的语气有些不耐，你不敢再多问，开始专心修炼《长春功》。",
                    "[旁白] 随着修炼深入，你感觉身体确实强健了不少，但墨大夫对你的进度似乎过于关心，让你隐隐感到不安。",
                    "[旁白] 某日，你在后山练习时，偶然发现了一个散发着微弱绿光的神秘小瓶。"
                ],
                choices: [
                    { text: "将小瓶藏起来，独自研究", next: 8 },
                    { text: "询问墨大夫这是何物", next: 9 }
                ]
            },
            {
                id: 6,
                title: "深入了解",
                era: "人界篇",
                location: "弟子居所",
                level: "炼气期三层",
                story: [
                    "[韩立] \"张师兄，你还知道墨大夫的什么事吗？\"",
                    "[张铁] \"我听说...前几年有个弟子修炼时出了意外，变得痴痴傻傻...不过这只是传闻，未必是真的。\"",
                    "[旁白] 张铁的话让你心中更加不安，但你已经拜入墨大夫门下，没有回头路了。",
                    "[旁白] 你开始修炼《长春功》，进步神速，墨大夫对你的表现十分满意。",
                    "[旁白] 某日，你在后山练习时，偶然发现了一个散发着微弱绿光的神秘小瓶。"
                ],
                choices: [
                    { text: "偷偷研究小瓶，不告诉任何人", next: 8 },
                    { text: "将小瓶交给墨大夫", next: 9 }
                ]
            },
            {
                id: 7,
                title: "暗中观察",
                era: "人界篇",
                location: "墨大夫居所",
                level: "炼气期三层",
                story: [
                    "[旁白] 你决定对墨大夫保持警惕，暗中观察他的一举一动。",
                    "[旁白] 你发现墨大夫经常独自外出，行踪神秘。而且他对《长春功》的修炼进度异常关注，远超普通师父对弟子的关心。",
                    "[旁白] 你修炼《长春功》的进展很快，墨大夫看你的眼神越来越满意，但这种满意让你感到毛骨悚然。",
                    "[旁白] 某日，你在后山练习时，偶然发现了一个散发着微弱绿光的神秘小瓶。"
                ],
                choices: [
                    { text: "将小瓶藏好，作为自己的秘密", next: 8 },
                    { text: "用树叶将小瓶掩盖，假装没看见", next: 11 }
                ]
            },
            {
                id: 8,
                title: "神秘小瓶",
                era: "人界篇",
                location: "七玄门后山",
                level: "炼气期四层",
                story: [
                    "[旁白] 你决定将神秘小瓶藏起来，不告诉任何人。经过多次试验，你发现这个小瓶能够吸收月光，并产生神奇的绿液。",
                    "[旁白] 这种绿液可以催生植物，让普通草药在短时间内变成百年灵药。",
                    "[旁白] 你利用这个秘密，开始培育珍稀药材，加速自己的修炼。",
                    "[旁白] 你的《长春功》进步神速，很快达到了第四层境界，墨大夫对此非常惊讶。",
                    "[旁白] 随着实力提升，你开始察觉到墨大夫看你的眼神中隐藏着一丝贪婪和急切。"
                ],
                choices: [
                    { text: "继续隐藏实力，暗中准备", next: 12 },
                    { text: "向墨大夫坦白小瓶的存在", next: 13 },
                    { text: "尝试拉拢张铁，共同应对", next: 14 }
                ]
            },
            {
                id: 9,
                title: "报告墨大夫",
                era: "人界篇",
                location: "墨大夫居所",
                level: "炼气期三层",
                story: [
                    "[韩立] \"墨大夫，弟子在后山发现了这个奇怪的小瓶。\"",
                    "[旁白] 墨大夫看到小瓶，眼中闪过一丝惊喜，但很快恢复正常。",
                    "[墨大夫] \"这只是一个普通的药瓶，没什么特别的。你先下去吧。\"",
                    "[旁白] 你注意到墨大夫将小瓶收起来时动作异常小心，心中升起疑虑。",
                    "[旁白] 几天后，你发现墨大夫的行踪更加神秘，经常深夜外出。",
                    "[旁白] 你的《长春功》修炼进展缓慢，墨大夫开始显得不耐烦。"
                ],
                choices: [
                    { text: "加倍努力修炼", next: 15 },
                    { text: "暗中跟踪墨大夫", next: 16 }
                ]
            },
            // 更多章节可以继续添加...
            {
                id: 25,
                title: "终结道祖",
                era: "仙界篇",
                location: "真仙界",
                level: "道祖",
                story: [
                    "[旁白] 经过无数年的修炼和征战，你终于成为了时间道祖，站在了修仙界的顶峰。",
                    "[旁白] 你领悟了时间的真谛，能够穿梭于过去未来，洞悉宇宙的奥秘。",
                    "[旁白] 但你深知，道祖之上还有更高的境界，修仙之路永无止境。",
                    "[南宫婉] \"夫君，我们终于走到了这一步。\"",
                    "[韩立] \"是啊，但这只是新的开始。\"",
                    "[旁白] 你与道侣南宫婉相视一笑，继续探索那无尽的修仙大道。"
                ],
                choices: [
                    { text: "重新开始修仙之旅", next: 0 },
                    { text: "探索道祖之上的境界", next: 26 }
                ]
            }
        ];

        // 游戏状态
        const gameState = {
            currentChapter: 0,
            cultivationLevel: "炼气期三层",
            skills: ["长春功"],
            items: ["神秘小瓶"],
            location: "七玄门",
            completedChapters: [0]
        };

        // 初始化游戏
        function initGame() {
            displayChapter(0);
            updateTimeline();
            
            // 添加事件监听器
            document.getElementById('choices-container').addEventListener('click', function(e) {
                if (e.target.classList.contains('choice-btn')) {
                    const nextChapter = parseInt(e.target.dataset.next);
                    displayChapter(nextChapter);
                }
            });
            
            document.getElementById('prev-chapter').addEventListener('click', function() {
                if (gameState.currentChapter > 0) {
                    displayChapter(gameState.currentChapter - 1);
                }
            });
            
            document.getElementById('next-chapter').addEventListener('click', function() {
                if (gameState.currentChapter < novelChapters.length - 1) {
                    displayChapter(gameState.currentChapter + 1);
                }
            });
            
            document.getElementById('jump-timeline').addEventListener('click', function() {
                document.querySelector('.timeline').scrollIntoView({ behavior: 'smooth' });
            });
            
            // 时间线点击事件
            document.querySelector('.timeline').addEventListener('click', function(e) {
                if (e.target.classList.contains('timeline-item')) {
                    const chapterId = parseInt(e.target.dataset.chapter);
                    displayChapter(chapterId);
                }
            });
        }

        // 显示章节内容
        function displayChapter(chapterId) {
            const chapter = novelChapters[chapterId];
            if (!chapter) return;
            
            gameState.currentChapter = chapterId;
            
            if (!gameState.completedChapters.includes(chapterId)) {
                gameState.completedChapters.push(chapterId);
            }
            
            // 更新故事内容
            const storyContainer = document.getElementById('story-container');
            storyContainer.innerHTML = chapter.story.map(text => 
                `<div class="story-text">${text}</div>`
            ).join('');
            
            // 更新选择项
            const choicesContainer = document.getElementById('choices-container');
            if (chapter.choices && chapter.choices.length > 0) {
                choicesContainer.innerHTML = chapter.choices.map(choice => 
                    `<button class="choice-btn" data-next="${choice.next}">${choice.text}</button>`
                ).join('');
            } else {
                choicesContainer.innerHTML = '<button class="choice-btn" data-next="' + (chapterId + 1) + '">继续</button>';
            }
            
            // 更新位置信息
            document.getElementById('location-name').textContent = chapter.location;
            document.getElementById('current-location').textContent = chapter.location.split(' - ')[0];
            
            // 更新境界
            document.getElementById('cultivation-level').textContent = chapter.level;
            
            // 更新进度条
            const progress = ((chapterId + 1) / novelChapters.length) * 100;
            document.getElementById('story-bar').style.width = `${progress}%`;
            document.getElementById('chapter-bar').style.width = `${progress}%`;
            
            // 更新篇章信息
            document.getElementById('era-name').textContent = chapter.era + " - " + chapter.title;
            
            // 更新章节导航
            document.getElementById('prev-chapter').disabled = chapterId === 0;
            document.getElementById('next-chapter').disabled = chapterId === novelChapters.length - 1;
            
            // 根据章节更新游戏状态
            updateGameState(chapterId);
            
            // 更新时间线
            updateTimeline();
        }

        // 更新时间线显示
        function updateTimeline() {
            const timelineItems = document.querySelectorAll('.timeline-item');
            timelineItems.forEach(item => {
                const chapterId = parseInt(item.dataset.chapter);
                item.classList.remove('completed', 'current', 'upcoming');
                
                if (gameState.completedChapters.includes(chapterId)) {
                    item.classList.add('completed');
                }
                
                if (chapterId === gameState.currentChapter) {
                    item.classList.add('current');
                }
                
                if (chapterId > gameState.currentChapter) {
                    item.classList.add('upcoming');
                }
            });
        }

        // 根据章节更新游戏状态
        function updateGameState(chapterId) {
            // 更新境界进度条
            let levelProgress = 5;
            if (chapterId >= 8) levelProgress = 10;
            if (chapterId >= 12) levelProgress = 20;
            if (chapterId >= 15) levelProgress = 30;
            if (chapterId >= 18) levelProgress = 50;
            if (chapterId >= 21) levelProgress = 70;
            if (chapterId >= 24) levelProgress = 90;
            if (chapterId >= 25) levelProgress = 100;
            
            document.getElementById('level-bar').style.width = `${levelProgress}%`;
            
            // 更新人界篇进度
            let mortalProgress = (chapterId / 12) * 100;
            if (chapterId > 12) mortalProgress = 100;
            document.getElementById('mortal-bar').style.width = `${mortalProgress}%`;
            
            // 更新功法
            if (chapterId >= 4 && !gameState.skills.includes("长春功")) {
                gameState.skills.push("长春功");
                updateSkillsList();
            }
            
            if (chapterId >= 8 && !gameState.skills.includes("青元剑诀")) {
                gameState.skills.push("青元剑诀");
                updateSkillsList();
            }
            
            // 更新物品
            if (chapterId >= 4 && !gameState.items.includes("神秘小瓶")) {
                gameState.items.push("神秘小瓶");
                updateItemsList();
            }
            
            if (chapterId >= 7 && !gameState.items.includes("虚天鼎")) {
                gameState.items.push("虚天鼎");
                updateItemsList();
            }
        }

        // 更新功法列表
        function updateSkillsList() {
            const skillsList = document.getElementById('skills-list');
            skillsList.innerHTML = gameState.skills.map(skill => {
                let desc = "";
                if (skill === "长春功") desc = "木属性基础功法，墨大夫所传授";
                if (skill === "青元剑诀") desc = "青元子的剑修功法，威力强大";
                return `
                    <li class="skill">
                        <div class="skill-name">${skill}</div>
                        <div class="skill-desc">${desc}</div>
                    </li>
                `;
            }).join('');
        }

        // 更新物品列表
        function updateItemsList() {
            const itemsList = document.getElementById('items-list');
            itemsList.innerHTML = gameState.items.map(item => {
                let desc = "";
                if (item === "神秘小瓶") desc = "可催生植物的神奇瓶子";
                if (item === "虚天鼎") desc = "虚天殿核心宝物，通天灵宝";
                return `
                    <li class="item">
                        <div class="item-name">${item}</div>
                        <div class="item-desc">${desc}</div>
                    </li>
                `;
            }).join('');
        }

        // 初始化游戏
        window.onload = initGame;
    </script>
</body>
</html>